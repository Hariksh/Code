from collections import deque

class Solution:
    def findValidOrder(self, n, m, c):
        adj = [[] for _ in range(n + 1)]
        indegree = [0] * (n + 1)

        # Build graph
        for i in range(m):
            for j in range(len(c[i]) - 1):
                u = c[i][j]
                v = c[i][j + 1]
                adj[u].append(v)
                indegree[v] += 1

        # Queue for nodes with indegree 0
        q = deque()
        for i in range(1, n + 1):
            if indegree[i] == 0:
                q.append(i)

        ans = []

        # Kahn's Algorithm
        while q:
            top = q.popleft()
            ans.append(top)

            for nei in adj[top]:
                indegree[nei] -= 1
                if indegree[nei] == 0:
                    q.append(nei)

        # If topological order does not include all nodes
        if len(ans) != n:
            return [-1]

        return ans
